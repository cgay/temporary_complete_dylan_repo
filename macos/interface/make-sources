
#  Dylan libraries for interfacing with MacOS.
#
#  This file controls the generation of source files that are created
#  automatically by adapting information from the MacOS C header files.

# Copyright (C) 1998-1999 Functional Objects, Inc. All rights reserved.

all: $(INTERFACELIB) library.dylan common-slots.pat

include sources.mak

INTERFACELIB=MixedMode.dylan \
             MacTypes.dylan \
             OSUtils.dylan \
             TextCommon.dylan \
             QuickdrawText.dylan \
             Quickdraw.dylan \
             Events.dylan \
             Notification.dylan \
             AEDataModel.dylan \
             AppleEvents.dylan \
             Finder.dylan \
             Files.dylan \
             Processes.dylan \
             Menus.dylan

INTERFACETOD=$(MACTOD) -module macos-interface

library.dylan: library.src $(INTERFACELIB)

common-slots.pat: library.dylan
	$(GEMA) -match -idchars '_-$$<>@%&*+=/?' \
	  -p 'unmap:-=_' \
	  -p '<I>-value-setter\I=export-slot\:\\C@unmap{$$1}\=$$1-value\@end\n;<I>=' \
	  $(COMDIR)/library.dylan | sort -u > $(COMSLOT)

DEPENDENCIES=$(COMMON-DEPENDENCIES) make-sources obsolete.text renamings.text

MixedMode.dylan: $(MACOSHDIR)/MixedMode.h $(DEPENDENCIES)

MacTypes.dylan: $(MACOSHDIR)/MacTypes.h $(DEPENDENCIES)

OSUtils.dylan: $(MACOSHDIR)/OSUtils.h $(DEPENDENCIES)

ConditionalMacros.dylan: $(MACOSHDIR)/ConditionalMacros.h $(DEPENDENCIES)

TextCommon.dylan: $(MACOSHDIR)/TextCommon.h $(DEPENDENCIES)

QuickdrawText.dylan: $(MACOSHDIR)/QuickdrawText.h $(DEPENDENCIES)

Quickdraw.dylan: $(MACOSHDIR)/Quickdraw.h $(DEPENDENCIES)

Events.dylan: $(MACOSHDIR)/Events.h $(DEPENDENCIES)

Notification.dylan: $(MACOSHDIR)/Notification.h $(DEPENDENCIES)

AEDataModel.dylan: $(MACOSHDIR)/AEDataModel.h $(DEPENDENCIES)

AppleEvents.dylan: $(MACOSHDIR)/AppleEvents.h $(DEPENDENCIES)

Finder.dylan: $(MACOSHDIR)/Finder.h $(DEPENDENCIES)

Files.dylan: $(MACOSHDIR)/Files.h $(DEPENDENCIES)

Processes.dylan: $(MACOSHDIR)/Processes.h $(DEPENDENCIES)

Menus.dylan: $(MACOSHDIR)/Menus.h $(DEPENDENCIES)

test.dylan: $(MACOSHDIR)/test.h $(DEPENDENCIES)

# remove all generated files
clean:
	rm -f $(INTERFACELIB) *.bak *.exp

# remove internal temporary files
tidy:
	rm -f *.bak *.exp

DTAGS=/u/dylan/tools/gnuemacs/dtags
TAGS: $(GLIB) special.dylan
	$(DTAGS) special.dylan $(GLIB)

tags: TAGS
