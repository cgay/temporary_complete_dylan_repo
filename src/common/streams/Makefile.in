######################################################################
##
## Copyright (c) 1994  Carnegie Mellon University
## All rights reserved.
## 
## Use and copying of this software and preparation of derivative
## works based on this software are permitted, including commercial
## use, provided that the following conditions are observed:
## 
## 1. This copyright notice must be retained in full on any copies
##    and on appropriate parts of any derivative works.
## 2. Documentation (paper or online) accompanying any system that
##    incorporates this software, or any part of it, must acknowledge
##    the contribution of the Gwydion Project at Carnegie Mellon
##    University.
## 
## This software is made available "as is".  Neither the authors nor
## Carnegie Mellon University make any warranty about the software,
## its performance, or its conformity to any specification.
## 
## Bug reports, questions, comments, and suggestions should be sent by
## E-mail to the Internet address "gwydion-bugs@cs.cmu.edu".
##
######################################################################
##
##  $Header: /home/housel/work/rcs/gd/src/common/streams/Attic/Makefile.in,v 1.3 1996/07/04 17:55:03 bfw Exp $
##
##  This is the makefile for the Mindy streams library, streams.dbc.
##

SHELL	=	/bin/sh

##
## begin autoconf'ed source
##

prefix	=		@prefix@
exec_prefix	=	@exec_prefix@
srcdir	=		@srcdir@

SRCDIR	=		${srcdir}
BINDIR	=		${exec_prefix}/bin
LIBDIR	=		${exec_prefix}/lib/mindy

CC	=		@CC@
CCOPTS	=		@CCOPTS@
CFLAGS	=		$(CCOPTS) -I${SRCDIR} @DEFS@ -DBINDIR=\"${BINDIR}\" -DLIBDIR=\"${LIBDIR}\"
YACC	=		@YACC@
YFLAGS	=		-d
LEX	=		@LEX@
LFLAGS	=		@LFLAGS@
RANLIB	=		@RANLIB@
INSTALL	=		@INSTALL@
INSTALL_PROGRAM	=	@INSTALL_PROGRAM@
INSTALL_DATA	=	@INSTALL_DATA@

LIBOBJS =		@LIBOBJS@
LIBS	=		@LIBS@

##
## end of configure written portion
##

MC	= ../../comp/mindycomp

all: new-streams-lib.dbc streams-lib.dbc

##
## New streams... soon to replace the stuff below.
##

NEWMINDYFLAGS = -lNew-Streams

NEWOBJS = new-library.dbc new-internals.dbc new-streams.dbc stream-reading.dbc stream-writing.dbc stream-lines.dbc stream-buffers.dbc wrapper-streams.dbc file-streams.dbc bbso-stream.dbc

new-streams-lib.dbc: ${NEWOBJS}
	cat ${NEWOBJS} > $@

new-library.dbc: ${SRCDIR}/new-library.dylan
	${MC} ${NEWMINDYFLAGS} -o new-library.dbc ${SRCDIR}/new-library.dylan
new-internals.dbc: ${SRCDIR}/new-internals.dylan
	${MC} ${NEWMINDYFLAGS} -o new-internals.dbc ${SRCDIR}/new-internals.dylan
new-streams.dbc: ${SRCDIR}/new-streams.dylan
	${MC} ${NEWMINDYFLAGS} -o new-streams.dbc ${SRCDIR}/new-streams.dylan
stream-reading.dbc: ${SRCDIR}/stream-reading.dylan
	${MC} ${NEWMINDYFLAGS} -o stream-reading.dbc ${SRCDIR}/stream-reading.dylan
stream-writing.dbc: ${SRCDIR}/stream-writing.dylan
	${MC} ${NEWMINDYFLAGS} -o stream-writing.dbc ${SRCDIR}/stream-writing.dylan
stream-lines.dbc: ${SRCDIR}/stream-lines.dylan
	${MC} ${NEWMINDYFLAGS} -o stream-lines.dbc ${SRCDIR}/stream-lines.dylan
stream-buffers.dbc: ${SRCDIR}/stream-buffers.dylan
	${MC} ${NEWMINDYFLAGS} -o stream-buffers.dbc ${SRCDIR}/stream-buffers.dylan
file-streams.dbc: ${SRCDIR}/file-streams.dylan
	${MC} ${NEWMINDYFLAGS} -o file-streams.dbc ${SRCDIR}/file-streams.dylan
wrapper-streams.dbc: ${SRCDIR}/wrapper-streams.dylan
	${MC} ${NEWMINDYFLAGS} -o wrapper-streams.dbc ${SRCDIR}/wrapper-streams.dylan
bbso-stream.dbc: ${SRCDIR}/bbso-stream.dylan
	${MC} ${NEWMINDYFLAGS} -o bbso-stream.dbc ${SRCDIR}/bbso-stream.dylan

##
## Old streams
##

MINDYFLAGS = -lStreams

OBJS = library.dbc internals.dbc streams.dbc standard-io.dbc

streams-lib.dbc: ${OBJS}
	cat ${OBJS} > $@

library.dbc: ${SRCDIR}/library.dylan
	${MC} ${MINDYFLAGS} -o library.dbc ${SRCDIR}/library.dylan
internals.dbc: ${SRCDIR}/internals.dylan
	${MC} ${MINDYFLAGS} -o internals.dbc ${SRCDIR}/internals.dylan
streams.dbc: ${SRCDIR}/streams.dylan
	${MC} ${MINDYFLAGS} -o streams.dbc ${SRCDIR}/streams.dylan
standard-io.dbc: ${SRCDIR}/standard-io.dylan
	${MC} ${MINDYFLAGS} -o standard-io.dbc ${SRCDIR}/standard-io.dylan

clean:
	rm -f ${OBJS} ${NEWOBJS} new-streams-lib.dbc streams-lib.dbc *~ \#* core

realclean:
	rm -f ${OBJS} ${NEWOBJS} new-streams-lib.dbc streams-lib.dbc Makefile *~ \#* core

install: streams-lib.dbc new-streams-lib.dbc
	${INSTALL_DATA} streams-lib.dbc new-streams-lib.dbc ${LIBDIR}
